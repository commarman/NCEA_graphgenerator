{% extends "layout.html" %}
{% block content %}
    <div class="info-box">
        <h1>Graph Comparison</h1>
        <p class="info-text">To compare data, first import data from NZQA</p>
        <div class="centred-content">
            <a class="form-button" href="/submit-nzqa">Import</a>
        </div>
        <p class="info-text">Select filters:</p>
        <div class="filter-form">
            <form action="/retrieve-graph-data" method="post">
                {{form.subject()}}
                {{form.submit()}}
                {{form.csrf_token}}
            </form>
        </div>
    </div>
    <canvas id="NCEAgraph" width="300px" height="100px"></canvas>
    {% with messages = get_flashed_messages() %}
        {% if messages|length > 0 %}
            <dialog open class="flash-dialog">
                {% for message in messages %}
                    <p>{{message}}</p>
                {% endfor %}
                <button onclick="this.parentElement.close()">Close</button>
            </dialog>
        {% endif %}
    {% endwith %}
    {% if graph %}
    {% block javascript %}
        <script>
            labels = JSON.parse({{labels | tojson}});
            data = JSON.parse({{data | tojson}});
            new Chart("NCEAgraph", {
                type="bar",
                data : {
                    labels: labels,
                    datasets = [{
                        data: data
                    }]
                }
            })
        </script>
    {% endblock %}
    {% endif %}
{% endblock %}